---
# options are prefork, worker or event
apache2_mpm: "worker"

apache2_packages_ontop:
# prefork MPM only 
#  - libapache2-mod-php5

apache2_modules:
  - actions
  - alias
  - auth_basic
  - authn_file
# authz_groupfile Debian only (not for Ubuntu)
#  - authz_groupfile
  - authz_host
  - authz_user
  - autoindex
# cgi prefork MPM only 
  - cgi
  - deflate
  - dir
  - env
  - expires
  - mime
  - negotiation
# php5 prefork MPM only 
#  - php5
  - reqtimeout
  - rewrite
  - setenvif
  - status
  - ssl

php5_packages_ontop:
  - php-pear
  - php-soap
  - php5-curl
  - php5-gd
  - php5-gmp
  - php5-mcrypt
  - php5-mysql

apache2_port: 80
apache2_ssl_port: 443

# List of IP addresses or CIDR networks allowed to connect to HTTP or HTTPS
# service. It will be configured in iptables firewall via 'ferm' role. If there
# are no entries, apache will accept connections from any IP address or network.
apache2_allow: []
apache2_group_allow: []
apache2_host_allow: []

post_max_size: "16M"
upload_max_filesize: "16M"
php_timezone: "Europe/Madrid"
memory_limit: "32M"
html_errors: "Off"

allow_override_htaccess: None

vhost_base_path: "/var/www"

#
# Disabled/deleted vhosts
#
deleted_vhost_sites:
  - {
      host: 'del.example.com',
      user: 'delexample',
      group: 'delexample',
      admin_email: 'admin@del.example.com',
      disabled: True
    }

disabled_vhost_sites: &disabled
  - {
      host: 'dev.example.com',
      user: 'devexample',
      group: 'devexample',
      admin_email: 'admin@dev.example.com',
      disabled: True
    }

apache2_https_enabled: no
apache2_ssl_params:
  SSLProtocol: '-ALL +SSLv3 +TLSv1 +TLSv1.1 +TLSv1.2'
  SSLCipherSuite: 'ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA:!RC4:HIGH:!MD5:!aNULL:!EDH'
  #old: ECDHE-RSA-AES128-SHA256:AES128-GCM-SHA256:!RC4:HIGH:!MD5:!aNULL:!EDH
  SSLHonorCipherOrder: 'on'
  SSLCompression: 'off'

apache2_expires: 'access plus 1 month'
apache2_expires_static_types:
  - 'image/gif'
  - 'image/jpg'
  - 'image/jpeg'
  - 'image/png'
  - 'image/vnd.microsoft.icon'
  - 'image/x-icon'
  - 'image/ico'
  - 'application/javascript'
  - 'application/pdf'
  - 'application/x-shockwave-flash'
  - 'text/javascript'
  - 'text/x-javascript'
  - 'text/css'

apache2_expires_default: 'access plus 1 day'

apache2_ferm_dependent_rules:
- type: 'dport_accept'
  dport: [ "{{ apache2_port | default('http') }}", 'https' ]
  saddr: '{{ apache2_allow + apache2_group_allow + apache2_host_allow }}'
  accept_any: True
  filename: 'apache2_dependency_accept'
  weight: '20'
